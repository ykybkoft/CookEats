<html xmlns:th="http://www.w3.org/1999/xhtml" xmlns:sec="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ë§ˆì´í˜ì´ì§€</title>
    <div th:replace="~{header.html :: navbar}"></div>
    <script src="https://use.fontawesome.com/releases/v6.6.0/js/all.js"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f4f4f4;
        }
        .container {
            background-color: #fff;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1, h2 {
            color: #2c3e50;
        }
        .profile-info {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .user-info-table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        margin: 20px 0;
        font-family: Arial, sans-serif;
        }
        .user-info-table th, .user-info-table td {
            padding: 15px;
            border: 1px solid #e0e0e0;
        }
        .user-info-table th {
            background-color: #f5f5f5;
            text-align: right;
            width: 30%;
            font-weight: bold;
        }
        .user-info-table tr:first-child th {
            border-top-left-radius: 10px;
        }
        .user-info-table tr:first-child td {
            border-top-right-radius: 10px;
        }
        .user-info-table tr:last-child th {
            border-bottom-left-radius: 10px;
        }
        .user-info-table tr:last-child td {
            border-bottom-right-radius: 10px;
        }
        .user-info-table input[type="password"] {
            width: 200px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .user-info-table button {
            padding: 8px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .user-info-table button:hover {
            background-color: #45a049;
        }
        .board-container {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        }
        h3 {
            color: #2c3e50;
            border-bottom: 2px solid #45A048;
            padding-bottom: 10px;
        }
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        th {
            background-color: #f5f5f5;
            font-weight: bold;
            color: #2c3e50;
        }
        tr:last-child td {
            border-bottom: none;
        }
        .edit-delete {
            text-align: center;
            font-size: 18px;
        }
        .empty-message {
            text-align: center;
            color: #7f8c8d;
            font-style: italic;
        }
        hr {
            border: 0;
            height: 1px;
            background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));
            margin: 20px 0;
        }


    </style>
</head>
<body>
<div class="container">
    <h1>ë§ˆì´í˜ì´ì§€</h1>
    <div class="profile-info">
        <i class="fa-regular fa-user fa-2x" style="margin:10px;"></i>
        <div>
            <h2 th:text="${user.name}"></h2>
        </div>
    </div>
    <h2>ê°œì¸ ì •ë³´ ìˆ˜ì •</h2>
    <table class="user-info-table">
        <tr>
            <th>ì´ë¦„</th>
            <td th:text="${user.name}"></td>
        </tr>
        <tr>
            <th>ë‹‰ë„¤ì„</th>
            <td th:text="${user.nick}"></td>
        </tr>
        <tr>
            <th>ì´ë©”ì¼</th>
            <td th:text="${user.email}"></td>
        </tr>
        <tr>
            <th>í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥</th>
            <form action="/member/password" method="post">
                <td>
                    <input name="password" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥">
                    <input name="type" type="hidden" value="password">
                    <button>ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</button>
                </td>
            </form>

        </tr>
        <tr>
            <th>íšŒì›íƒˆí‡´</th>
            <form action="/member/password" method="post">
                <td>
                    <input name="password" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥">
                    <input name="type" type="hidden" value="delete">
                    <button>íšŒì› íƒˆí‡´</button>
                </td>
            </form>

        </tr>

    </table>


    <h2>í™œë™ ìš”ì•½</h2>
    <div class="board-container">
        <h3>ììœ  ê²Œì‹œíŒ</h3>
        <div th:if="!${#lists.isEmpty(normal)}">
            <table>
                <tr>
                    <th>ì œëª©</th>
                    <th>ë‚´ìš©</th>
                    <th>ìˆ˜ì •</th>
                    <th>ì‚­ì œ</th>
                </tr>
                <tr th:each="normal : ${normal}">
                    <td th:text="${normal.title}"></td>
                    <td th:text="${normal.content}"></td>
                    <td class="edit-delete">âœï¸</td>
                    <td class="edit-delete">ğŸ—‘ï¸</td>
                </tr>
            </table>
        </div>
        <div th:if="${#lists.isEmpty(normal)}" class="empty-message">
            <p>ì‘ì„±í•œ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>
        </div>

        <hr>

        <h3>ì¥í„° ê²Œì‹œíŒ</h3>
        <div th:if="${!#lists.isEmpty(share)}">
            <table>
                <tr>
                    <th>ì œëª©</th>
                    <th>ë‚´ìš©</th>
                    <th>ìˆ˜ì •</th>
                    <th>ì‚­ì œ</th>
                </tr>
                <tr th:each="share : ${share}">
                    <td th:text="${share.title}"></td>
                    <td th:text="${share.content}"></td>
                    <td class="edit-delete">
                        <button th:onclick="|location.href='/boardShare/edit/${share.id}'|">âœï¸</button>
                    </td>
                    <td class="edit-delete">
                        <form
                                id="delete-contents"
                                th:action="@{/boardShare/delete/{id}(id=${share.id})}"
                                method="post"
                                onsubmit="return confirmDelete(event)"
                                style="padding-left: 5px"
                        >
                            <button type="submit">ğŸ—‘ï¸</button>
                        </form>
                    </td>
                </tr>
            </table>
        </div>
        <div th:if="${#lists.isEmpty(share)}" class="empty-message">
            <p>ì‘ì„±í•œ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>
        </div>

        <hr>

        <h3>ë‚˜ì˜ ë ˆì‹œí”¼</h3>
        <div th:if="${!#lists.isEmpty(recipe)}">
            <table>
                <tr>
                    <th>ì œëª©</th>
                    <th>ìˆ˜ì •</th>
                    <th>ì‚­ì œ</th>
                </tr>
                <tr th:each="recipe : ${recipe}">
                    <td th:text="${recipe.RCP_NM}"></td>
                    <td class="edit-delete">
                        <a th:href="@{'/boardRecipe/update/' + ${recipe.id}}" class="button">âœï¸</a>
                    </td>
                    <td class="edit-delete">
                        <a href="#" th:onclick="'deleteRecipe(' + ${recipe.id} + ');'" class="button">ğŸ—‘ï¸</a>
                    </td>
                </tr>
            </table>
        </div>
        <div th:if="${#lists.isEmpty(recipe)}" class="empty-message">
            <p>ì‘ì„±í•œ ë ˆì‹œí”¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
        </div>
    </div>
</div>




<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    const param = new URLSearchParams(window.location.search);

    if(param.get('result')=='false'){
        alert('ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.');
    }

    function deleteRecipe(recipeId) {
        if (confirm('ì´ ê²Œì‹œê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            fetch(`/boardRecipe/delete/${recipeId}`, {
                method: 'POST'
            })
            .then(response => {
                if (response.ok) {
                    alert('ê²Œì‹œê¸€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                    window.location.href = '/member/myPage';
                } else {
                    alert('ê²Œì‹œê¸€ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('ê²Œì‹œê¸€ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            });
        }
    }

    // ê²Œì‹œê¸€ ì‚­ì œ ì•ˆë‚´ ë©”ì„¸ì§€
         function confirmDelete(event) {
             const message = 'ê²Œì‹œê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?';
             if(!confirm(message)){
                 event.preventDefault();
                 return false;
             }
             // í™•ì¸ ë²„íŠ¼ í´ë¦­ì‹œ
             return true;
         }

</script>

</body>
</html>